#:kivy 1.10.0
#:import Clock kivy.clock.Clock

<Manager>:
    id: screen_manager

    Screen:
        name: 'home'

        BoxLayout
            id: starting
            orientation: 'vertical'

            Label:
                text: ''
                fontsize: 50

            Label:
                text: 'Welcome! Make a Selection in Each Row:'
                fontsize: 80
                color: 0,0,1,1
                canvas.before:
                    Color: 
                        rgb: 1,1,0


            BoxLayout 
                id: big_rew
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'BIG reward'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0.3 sec'

                CheckBox:
                    id: big_rew_pt3_sec
                    group: 'big_rew'
                    active: root.big_rew_3

                Label: 
                    text: '0.5 sec'

                CheckBox:
                    id: big_rew_pt5_sec
                    group: 'big_rew'
                    active: root.big_rew_5

                Label: 
                    text: '0.7 sec'

                CheckBox:
                    id: big_rew_pt7_sec
                    group: 'big_rew'
                    active: root.big_rew_7

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
            
            BoxLayout 
                id: top
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Which Juicer?        '
                    color: 1, 1, 0, 1
           
                Label: 
                    text: 'Old yellow'

                CheckBox:
                    group: 'juicer'
                    id: yellow
                    active: root.juicer_y
            
                Label: 
                    text: 'New red'

                CheckBox:
                    group: 'juicer'
                    id: red
                    active: root.juicer_r

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: params:
                orientation: 'horizontal'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'Which trials to include?'
                    color: 1, 1, 0, 1                    


                Label: 
                    text: 'Power grasp'

                CheckBox:
                    id: giant_hole
                    active: root.power

                Label: 
                    text: 'Tripod'

                CheckBox:
                    id: tripod
                    active: root.tripod

                Label: 
                    text: 'Pinch'

                CheckBox:
                    id: pinch
                    active: root.pinch

                Label: 
                    text: 'Tiny'
                CheckBox: 
                    id: tiny
                    active: root.tiny

                Label:
                    text: 'pinch x 3'
                CheckBox:
                    id: pinch3
                    active: root.pinch3

                Label:
                    text: ''
                    fontsize: 50
                
                Label:
                    text: ''
                    fontsize: 50
                
                Label:
                    text: ''
                    fontsize: 50




            BoxLayout:
                id: test
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.2, 0.2, 0.5, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Auto-Quit After: '
                    color: 1, 1, 0, 1

                Label: 
                    text: '25 trials'
                CheckBox:
                    id: twenty_five_trials
                    group: 'trials'
                    active: root.trls_25

                Label:
                    text: '50 trials'
                CheckBox:
                    id: fifty_trials
                    group: 'trials'
                    active: root.trls_50
                    

                Label:
                    text: 'Dont AutoQuit'
                CheckBox:
                    id: no_trials
                    group: 'trials'
                    active: root.trls_inf

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: test
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.2, 0.2, 0.5, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Testing or Monkey Time?'
                    color: 1, 1, 0, 1

                Label: 
                    text: 'Testing'
                CheckBox:
                    id: testing
                    group: 'testing'

                Label:
                    text: 'Monkey Time'
                CheckBox:
                    id: monk_time
                    group: 'testing'
                    active: True
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
            
            Button:
                text: 'Line Up Motor to the Rest position: Play R2G'
                halign: 'center'
                valign: 'middle'
                font_size: 50
                text_size: self.size
                on_release: 
                    root.current = 'game_screen'
                    game.init(dict(haribo=True, butters=False, nike=False,
                    fifi=False, test=False), 
                    dict(rew_manual=False, rew_start=False, rew_start_and_grasp=False, rew_grasp=True, snd_only=False, small_rew=[True, False, False], big_rew=[big_rew_pt3_sec.active, big_rew_pt5_sec.active, big_rew_pt7_sec.active]), 
                    dict(rew_var=[True, False, False]), 
                    dict(test=[testing.active, monk_time.active]), 
                    dict(start_hold=[False, False, True, False, False], 
                    grasp_hold = [False, False, False, True, False, False]), 
                    dict(autoquit=[twenty_five_trials.active, fifty_trials.active, no_trials.active]), 
                    dict(gto=[False, True, False]),
                    dict(use_cap=[False, True]), 
                    dict(tsk_opt=[False, False, True]), 
                    dict(trials=[giant_hole.active, tripod.active, pinch.active, tiny.active,
                    pinch3.active]), dict(juicer=[yellow.active, red.active]))

                    Clock.schedule_interval(game.update, 1.0 / 60.0)
            Label:
                text: ''
                fontsize: 50
            Label:
                text: ''
                fontsize: 50
                
    Screen:
        name: 'game_screen'
        R2Game:
            id: game

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 70
                text: game.grasp_rew_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 70
                text: game.grasp_rew_param


            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 120
                text: game.button_rew_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 120
                text: game.button_rew_param

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 170
                text: game.grasp_hold_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 170
                text: game.grasp_hold_param

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 220
                text: game.button_hold_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 220
                text: game.button_hold_param

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 270
                text: game.n_trials_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 270
                text: game.n_trials_param

        BoxLayout:
            id: test3
            orientation: 'vertical'
            size_hint: (1., .5)

            BoxLayout: 
                id: test3
                orientation: 'horizontal'
                Button:
                    text: 'Exit Gracefully'
                    font_size: 30
                    on_release: game.quit_from_app()
                    background_color: (.1, 0.1, 0.8, 1.0)

            BoxLayout: 
                id: test4
                orientation: 'horizontal'

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'
                    Label: 
                        text: ''
                        fontsize: 50

                BoxLayout:
                    id: test3
                    orientation: 'vertical'

                    Label:
                        text: 'BUTTON rew count:'
                        font_size: 30

                    Label:
                        text: str(game.small_reward_cnt)
                        font_size: 30
                
                BoxLayout 
                    id: top
                    orientation: 'vertical'

                    Label:
                        text: 'GRASP rew count:'
                        font_size: 30

                    Label:
                        text: str(game.big_reward_cnt)
                        font_size: 30

                BoxLayout:
                    id: test3
                    orientation: 'vertical'

                    Label:
                        text: 'Go to Notch:'
                        font_size: 30

                    Label:
                        text: str(game.what_notch_going_to)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'Current Notch:'
                        font_size: 30 

                    Label: 
                        text: str(game.what_notch_currently_at)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'speed:'
                        font_size: 20 

                    Label: 
                        text: str(game.speed)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'hall cnt:'
                        font_size: 20 

                    Label: 
                        text: str(game.hall_cnt)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'end cnt:'
                        font_size: 20 

                    Label: 
                        text: str(game.end_cnt)
                        font_size: 30


                BoxLayout:
                    id: test3
                    orientation: 'vertical'
                    Label:
                        text: ''
                        fontsize: 50