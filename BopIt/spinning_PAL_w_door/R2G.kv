#:kivy 1.10.0
#:import Clock kivy.clock.Clock

<Manager>:
    id: screen_manager

    Screen:
        name: 'home'

        BoxLayout
            id: starting
            orientation: 'vertical'

            Label:
                text: ''
                fontsize: 50

            Label:
                text: 'Welcome! Make a Selection in Each Row:'
                fontsize: 80
                color: 0,0,1,1
                canvas.before:
                    Color: 
                        rgb: 1,1,0

            BoxLayout 
                id: top
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Reward Setup:        '
                    color: 1, 1, 0, 1

                Label: 
                    text: 'No Auto Reward (all manual)'

                CheckBox:
                    group: 'rew'
                    id: rew_noauto_chk
                    active: root.rew_manual
            
                Label: 
                    text: 'SMALL rew for start button touch'

                CheckBox:
                    group: 'rew'
                    id: rew_anytouch_chk
                    active: root.rew_start
           
                Label: 
                    text: 'SMALL rew for start button touch\n pls BIG rew for grasp'

                CheckBox:
                    group: 'rew'
                    id: rew_anytouch_pls_targ_chk
                    active: root.rew_start_and_grasp
            
                Label: 
                    text: 'BIG rew for grasp pls sound for both'

                CheckBox:
                    group: 'rew'
                    id: rew_targ_chk
                    active: root.rew_grasp
                    

                Label: 
                    text: 'SOUND for button AND grasp'

                CheckBox:
                    group: 'rew'
                    id: sound_only_chk
                    active: root.rew_snd

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

            BoxLayout
                id: starting3
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: 'Task Opts:'
                    color: 1, 1, 0, 1
                    fontsize: 50
                    
                Label: 
                    text: 'Only Gripper'
                    fontsize: 28
                    halign: 'center'                        
                
                CheckBox: 
                    group: 'tsk'
                    id: tsk_grip
                    active: root.only_gripper
                    

                Label: 
                    text: 'Only Button'
                    fontsize: 28
                    halign: 'center'                        
                
                CheckBox: 
                    group: 'tsk'
                    id: tsk_button
                    active: root.only_button
                
                Label: 
                    text: 'Both Button and Grip'
                    fontsize: 28
                    halign: 'center' 
                              
                
                CheckBox: 
                    group: 'tsk'
                    id: tsk_both
                    active: root.button_grip

                   
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50



            BoxLayout
                id: starting2
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: 'Animal Names:'
                    color: 1, 1, 0, 1
                    fontsize: 50
                    
                Label: 
                    text: 'Haribo'
                    fontsize: 28
                    halign: 'center'                        
                
                CheckBox: 
                    group: 'check'
                    id: chk_h
                    active: root.monk_haribo

                Label: 
                    text: 'Butters'
                    fontsize: 28
                    halign: 'center'                        
                
                CheckBox: 
                    group: 'check'
                    id: chk_b
                    active: root.monk_butters

                Label: 
                    text: 'Nike'
                    fontsize: 28
                    halign: 'center' 
                    active: root.monk_nike                       
                
                CheckBox: 
                    group: 'check'
                    id: chk_n
                   
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout 
                id: small_rew
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.2, 0.2, 0.5, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'SMALL reward'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0.1 sec'

                CheckBox:
                    id: small_rew_pt1_sec
                    group: 'small_rew'
                    active: root.small_rew_1

                Label: 
                    text: '0.3 sec'

                CheckBox:
                    id: small_rew_pt3_sec
                    group: 'small_rew'
                    active: root.small_rew_3

                Label: 
                    text: '0.5 sec'

                CheckBox:
                    id: small_rew_pt5_sec
                    group: 'small_rew'
                    active: root.small_rew_5

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout 
                id: big_rew
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'BIG reward'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0.3 sec'

                CheckBox:
                    id: big_rew_pt3_sec
                    group: 'big_rew'
                    active: root.big_rew_3

                Label: 
                    text: '0.5 sec'

                CheckBox:
                    id: big_rew_pt5_sec
                    group: 'big_rew'
                    active: root.big_rew_5

                Label: 
                    text: '0.7 sec'

                CheckBox:
                    id: big_rew_pt7_sec
                    group: 'big_rew'
                    active: root.big_rew_7

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
            
            BoxLayout 
                id: top
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Which Juicer?        '
                    color: 1, 1, 0, 1
           
                Label: 
                    text: 'Old yellow'

                CheckBox:
                    group: 'juicer'
                    id: yellow
                    active: root.juicer_y
            
                Label: 
                    text: 'New red'

                CheckBox:
                    group: 'juicer'
                    id: red
                    active: root.juicer_r

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: params:
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Reward Variability'
                    color: 1, 1, 0, 1

                Label: 
                    text: 'Reward All'
                CheckBox:
                    id: rew_all
                    group: 'rew_var'
                    active: root.rew_all

                Label: 
                    text: 'Reward 50% '

                CheckBox:
                    id: rew_50
                    group: 'rew_var'
                    active: root.rew_50

                Label: 
                    text: 'Reward 33% w/ 10% doubled'

                CheckBox:
                    id: rew_30
                    group: 'rew_var'
                    active: root.rew_30


                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: params:
                orientation: 'horizontal'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'Button Hold'
                    color: 1, 1, 0, 1                    


                Label: 
                    text: '0.0 sec'

                CheckBox:
                    id: zero_hold
                    group: 'hold_time'
                    active: root.button_0

                Label: 
                    text: '0.1 sec'

                CheckBox:
                    id: hund_hold
                    group: 'hold_time'
                    active: root.button_1

                Label: 
                    text: '0.2 sec'

                CheckBox:
                    id: two_hund_hold
                    group: 'hold_time'
                    active: root.button_2


                Label: 
                    text: '0.3 sec'
                
                CheckBox:
                    id: three_hund_hold
                    group: 'hold_time'
                    active: root.button_3


                Label: 
                    text: '0.4 sec'
                    
                CheckBox:
                    id: four_hund_hold
                    group: 'hold_time'
                    active: root.button_4


                Label:
                    text: ''
                    fontsize: 50
                
                Label:
                    text: ''
                    fontsize: 50
                
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: params:
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'GRASP Hold'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0 sec'
                CheckBox:
                    id: g_zero_sec
                    group: 'ghold_time'
                    active: root.grasp_0

                Label: 
                    text: '0.15 sec'
                CheckBox:
                    id: g_eighteen_sec
                    group: 'ghold_time'
                    active: root.grasp_15
                    
                Label: 
                    text: '0.20 sec'
                CheckBox: 
                    id: g_twenty_sec
                    group: 'ghold_time'
                    active: root.grasp_20

                Label: 
                    text: '0.25 sec'
                CheckBox:
                    id: g_quarter_sec
                    group: 'ghold_time'
                    active: root.grasp_25

                Label: 
                    text: '0.35 sec'

                CheckBox:
                    id: g_thirty_five_sec
                    group: 'hold_time'
                    active: root.grasp_35

                Label: 
                    text: '0.5 sec'
                CheckBox:
                    id: g_half_sec
                    group: 'ghold_time'
                    active: root.grasp_50

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50


            BoxLayout:
                id: params:
                orientation: 'horizontal'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'Which trials to include?'
                    color: 1, 1, 0, 1                    


                Label: 
                    text: 'Power grasp'

                CheckBox:
                    id: giant_hole
                    active: root.power

                Label: 
                    text: 'Tripod'

                CheckBox:
                    id: tripod
                    active: root.tripod

                Label: 
                    text: 'Pinch'

                CheckBox:
                    id: pinch
                    active: root.pinch

                Label: 
                    text: 'Tiny'
                CheckBox: 
                    id: tiny
                    active: root.tiny

                Label:
                    text: 'pinch x 3'
                CheckBox:
                    id: pinch3
                    active: root.pinch3

                Label:
                    text: ''
                    fontsize: 50
                
                Label:
                    text: ''
                    fontsize: 50
                
                Label:
                    text: ''
                    fontsize: 50


            BoxLayout:
                id: params:
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'GRASP Timeout'
                    color: 1, 1, 0, 1

                Label: 
                    text: '5 sec'
                CheckBox:
                    id: gto_five_sec
                    group: 'gto'
                    active: root.grasp_to5
                    

                Label: 
                    text: '10 sec'
                CheckBox:
                    id: gto_ten_sec
                    group: 'gto'
                    active: root.grasp_to10

                Label: 
                    text: 'Infinity'
                CheckBox:
                    id: gto_inf
                    group: 'gto'
                    active: root.grasp_toinf
                    
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50



            BoxLayout:
                id: test
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.2, 0.2, 0.5, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Auto-Quit After: '
                    color: 1, 1, 0, 1

                Label: 
                    text: '25 trials'
                CheckBox:
                    id: twenty_five_trials
                    group: 'trials'
                    active: root.trls_25

                Label:
                    text: '50 trials'
                CheckBox:
                    id: fifty_trials
                    group: 'trials'
                    active: root.trls_50
                    

                Label:
                    text: 'Dont AutoQuit'
                CheckBox:
                    id: no_trials
                    group: 'trials'
                    active: root.trls_inf

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: test
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.2, 0.2, 0.5, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Testing or Monkey Time?'
                    color: 1, 1, 0, 1

                Label: 
                    text: 'Testing'
                CheckBox:
                    id: testing
                    group: 'testing'

                Label:
                    text: 'Monkey Time'
                CheckBox:
                    id: monk_time
                    group: 'testing'
                    active: True
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
            
            Button:
                text: 'Line Up Motor to the Rest position: Play R2G'
                halign: 'center'
                valign: 'middle'
                font_size: 50
                text_size: self.size
                on_release: 
                    root.current = 'game_screen'
                    game.init(dict(haribo=chk_h.active, butters=chk_b.active, nike=chk_n.active), 
                    dict(rew_manual=rew_noauto_chk.active, rew_start=rew_anytouch_chk.active, rew_start_and_grasp=rew_anytouch_pls_targ_chk.active, rew_grasp=rew_targ_chk.active, snd_only=sound_only_chk.active, small_rew=[small_rew_pt1_sec.active, small_rew_pt3_sec.active, small_rew_pt5_sec.active], big_rew=[big_rew_pt3_sec.active, big_rew_pt5_sec.active, big_rew_pt7_sec.active]), 
                    dict(rew_var=[rew_all.active, rew_50.active, rew_30.active]), 
                    dict(test=[testing.active, monk_time.active]), 
                    dict(start_hold=[zero_hold.active, hund_hold.active, two_hund_hold.active, three_hund_hold.active, four_hund_hold.active], grasp_hold = [g_zero_sec.active, g_eighteen_sec.active, g_twenty_sec.active, g_quarter_sec.active, g_thirty_five_sec.active, g_half_sec.active]), 
                    dict(autoquit=[twenty_five_trials.active, fifty_trials.active, no_trials.active]), 
                    dict(gto=[gto_five_sec.active, gto_ten_sec.active, gto_inf.active]),
                    dict(use_cap=[False, True]), 
                    dict(tsk_opt=[tsk_grip.active, tsk_button.active, tsk_both.active]), 
                    dict(trials=[giant_hole.active, tripod.active, pinch.active, tiny.active,
                    pinch3.active]), dict(juicer=[yellow.active, red.active]))

                    Clock.schedule_interval(game.update, 1.0 / 60.0)
            Label:
                text: ''
                fontsize: 50
            Label:
                text: ''
                fontsize: 50
                
    Screen:
        name: 'game_screen'
        R2Game:
            id: game

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 70
                text: game.grasp_rew_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 70
                text: game.grasp_rew_param


            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 120
                text: game.button_rew_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 120
                text: game.button_rew_param

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 170
                text: game.grasp_hold_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 170
                text: game.grasp_hold_param

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 220
                text: game.button_hold_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 220
                text: game.button_hold_param

            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 2/8
                top: root.top - 270
                text: game.n_trials_txt
            Label:
                color: .5,.5,.5,1
                font_size: 20
                center_x: root.width * 5/8
                top: root.top - 270
                text: game.n_trials_param

        BoxLayout:
            id: test3
            orientation: 'vertical'
            size_hint: (1., .5)

            BoxLayout: 
                id: test3
                orientation: 'horizontal'
                Button:
                    text: 'Exit Gracefully'
                    font_size: 30
                    on_release: game.quit_from_app()
                    background_color: (.1, 0.1, 0.8, 1.0)

            BoxLayout: 
                id: test4
                orientation: 'horizontal'

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'
                    Label: 
                        text: ''
                        fontsize: 50

                BoxLayout:
                    id: test3
                    orientation: 'vertical'

                    Label:
                        text: 'BUTTON rew count:'
                        font_size: 30

                    Label:
                        text: str(game.small_reward_cnt)
                        font_size: 30
                
                BoxLayout 
                    id: top
                    orientation: 'vertical'

                    Label:
                        text: 'GRASP rew count:'
                        font_size: 30

                    Label:
                        text: str(game.big_reward_cnt)
                        font_size: 30

                BoxLayout:
                    id: test3
                    orientation: 'vertical'

                    Label:
                        text: 'Go to Notch:'
                        font_size: 30

                    Label:
                        text: str(game.what_notch_going_to)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'Current Notch:'
                        font_size: 30 

                    Label: 
                        text: str(game.what_notch_currently_at)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'speed:'
                        font_size: 20 

                    Label: 
                        text: str(game.speed)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'hall cnt:'
                        font_size: 20 

                    Label: 
                        text: str(game.hall_cnt)
                        font_size: 30

                BoxLayout: 
                    id: test3
                    orientation: 'vertical'

                    Label: 
                        text: 'end cnt:'
                        font_size: 20 

                    Label: 
                        text: str(game.end_cnt)
                        font_size: 30


                BoxLayout:
                    id: test3
                    orientation: 'vertical'
                    Label:
                        text: ''
                        fontsize: 50