#:kivy 1.10.0
#:import Clock kivy.clock.Clock

<Manager>:
    id: screen_manager

    Screen:
        name: 'home'

        BoxLayout
            id: starting
            orientation: 'vertical'

            Label:
                text: ''
                fontsize: 50

            Label:
                text: 'Welcome! Make a Selection in Each Row:'
                fontsize: 80
                color: 0,0,1,1
                canvas.before:
                    Color: 
                        rgb: 1,1,0
                        
            BoxLayout
                id: starting2
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: 'Animal Names:'
                    color: 1, 1, 0, 1
                    fontsize: 50
                    
                Label: 
                    text: 'Haribo'
                    fontsize: 28
                    halign: 'center'                        
                CheckBox: 
                    group: 'check'
                    id: chk_har
                    active: root.is_haribo  
                Label: 
                    text: 'Nike'
                    fontsize: 28
                    halign: 'center'
                CheckBox: 
                    group: 'check'
                    id: chk_nike
                    active: root.is_nike
                Label: 
                    text: 'Testing'
                    fontsize: 28
                    halign: 'center' 
                CheckBox: 
                    group: 'check'
                    id: chk_test
                    active: root.is_testing
                   
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50


            
            BoxLayout 
                id: big_rew
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'Maximum Reward'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0.3 sec'
                CheckBox:
                    id: big_rew_pt3_sec
                    group: 'big_rew'
                    active: root.is_threw300

                Label: 
                    text: '0.5 sec'
                CheckBox:
                    id: big_rew_pt5_sec
                    group: 'big_rew'
                    active: root.is_threw500

                Label: 
                    text: '0.7 sec'
                CheckBox:
                    id: big_rew_pt7_sec
                    group: 'big_rew'
                    active: root.is_threw700
                    
                Label: 
                    text: '0.9 sec'
                CheckBox:
                    id: big_rew_pt9_sec
                    group: 'big_rew'
                    active: root.is_threw900
                    
                Label: 
                    text: '1.1 sec'
                CheckBox:
                    id: big_rew_1pt1_sec
                    group: 'big_rew'
                    active: root.is_threw1100

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
            
            BoxLayout:
                id: screen_top
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'Button hold time (sec): '
                    color: 1, 1, 0, 1
                
                Label: 
                    text: '0.1 sec'
                CheckBox:
                    id: bht100
                    group: 'button_hold'
                    active: root.is_bht100

                Label: 
                    text: '0.3 sec'
                CheckBox:
                    id: bht300
                    group: 'button_hold'
                    active: root.is_bht300

                Label: 
                    text: '0.5 sec'
                CheckBox:
                    id: bht500
                    group: 'button_hold'
                    active: root.is_bht500

                Label: 
                    text: '0.7 sec'
                CheckBox:
                    id: bht700
                    group: 'button_hold'
                    active: root.is_bht700

                Label: 
                    text: '0.9 sec'
                CheckBox:
                    id: bht900
                    group: 'button_hold'
                    active: root.is_bht900

                Label: 
                    text: '0.2-0.4 sec'
                CheckBox:
                    id: bht200_to_400
                    group: 'button_hold'
                    active: root.is_bht200_to_400

                Label: 
                    text: '0.6-0.8 sec'
                CheckBox:
                    id: bht600_to_800
                    group: 'button_hold'
                    active: root.is_bht600_to_800

                Label: 
                    text: '0.8-1.0 sec'
                CheckBox:
                    id: bht800_to_1000
                    group: 'button_hold'
                    active: root.is_bht800_to_1000

                Label: 
                    text: '0.9-1.2 sec'
                CheckBox:
                    id: bht900_to_1200
                    group: 'button_hold'
                    active: root.is_bht900_to_1200

                Label: 
                    text: '1.1-1.4 sec'
                CheckBox:
                    id: bht1100_to_1400
                    group: 'button_hold'
                    active: root.is_bht1100_to_1400

            
            
            BoxLayout:
                id: test
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: 0.1, 0.1, 0.7, 0.5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Auto-Quit After: '
                    color: 1, 1, 0, 1

                Label: 
                    text: '5 trials'
                CheckBox:
                    id: five_trials
                    group: 'trials'
                    active: root.is_autoqt5

                Label: 
                    text: '10 trials'
                CheckBox:
                    id: ten_trials
                    group: 'trials'
                    active: root.is_autoqt10

                Label: 
                    text: '15 trials'
                CheckBox:
                    id: fifteen_trials
                    group: 'trials'
                    active: root.is_autoqt15

                Label: 
                    text: '20 trials'
                CheckBox:
                    id: twenty_trials
                    group: 'trials'
                    active: root.is_autoqt20

                Label: 
                    text: '25 trials'
                CheckBox:
                    id: twenty_five_trials
                    group: 'trials'
                    active: root.is_autoqt25

                Label:
                    text: '50 trials'
                CheckBox:
                    id: fifty_trials
                    group: 'trials'
                    active: root.is_autoqt50
                    
                Label:
                    text: '100 trials!'
                CheckBox:
                    id: hundred_trials
                    group: 'trials'
                    active: root.is_autoqt100

                Label:
                    text: 'Dont AutoQuit'
                CheckBox:
                    id: no_trials
                    group: 'trials'
                    active: root.is_autoqtnever

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50


            Button:
                text: 'Play Target Chase Game'
                halign: 'center'
                valign: 'middle'
                font_size: 50
                text_size: self.size
                on_release: 
                    root.current = 'splash_start'
                    splash.init(
                    dict(haribo=chk_har.active, fifi=False, nike=chk_nike.active, butters=False, testing=chk_test.active), 
                    
                    dict(button_rew=[True, False, False, False], 
                    min_rew=[True, False, False, False, False],
                    big_rew=[big_rew_pt3_sec.active, big_rew_pt5_sec.active, big_rew_pt7_sec.active, big_rew_pt9_sec.active, big_rew_1pt1_sec.active]), 
                    
                    dict(targ_rad=[False, False, False, False, False, False, False, True, False, False], 
                    eff_targ_rad=[True, False, False, False, False, False],
                    seq=[False, False, False, False, False, False, False, False, True],
                    targ1_pos=[True,False, False, False, False, False, False, False, False,False],
                    targ2_pos=[True, False,False, False, False, False, False, False ,False, False, False],
                    targ3_pos=[True, False,False, False, False, False, False, False ,False, False],
                    targ4_pos=[True, False,False, False, False, False, False, False ,False, False,],
                    time_to_next_targ=[True, False, False, False, False, False]),

                    dict(button_hold=[bht300.active, bht500.active, bht700.active, bht900.active, 
                    bht200_to_400.active, bht600_to_800.active, bht800_to_1000.active, 
                    bht900_to_1200.active, bht1100_to_1400.active],
                    hold=[True, False, False, False, False, False, False, False, False]), 
                    
                    dict(autoquit=[five_trials.active, 
                    ten_trials.active, fifteen_trials.active, twenty_trials.active,
                    twenty_five_trials.active, fifty_trials.active, hundred_trials.active, no_trials.active]),
                    
                    dict(rew_var=[True, False, False]),
                    
                    dict(t1tt=[False, False, False, False,False, False,False, False, True],
                    tt=[False,False, False, False, False, False, False, False, True]),
                    
                    dict(drag=[False,True]),
                    
                    dict(nudge_x_t1=[False, True, False,False, False,False,False],
                    nudge_x_t2=[False, False, False, True, False, False, False],
                    nudge_x_t3=[False, True, False, False, False, False, False],
                    nudge_x_t4=[False, False, False, True, False, False, False]),
                    
                    dict(screen_top=[False, False, False, False, 
                    False, True, False], 
                    
                    screen_bot=[True, False, False, False, False, False, False]),
                    
                    dict(juicer=[False, True]))

            Label:
                text: ''
                fontsize: 50
            Label:
                text: ''
                fontsize: 50

    Screen: 
        name: 'splash_start'
        Splash:
            id: splash

        BoxLayout:
            id: test
            orientation: 'vertical'
         
            Label:
                text: 'Parameters Cached!! \n \n Prepare the Monkey! \n \n Pausing Until Start Button Pressed. '
                halign: 'center'
                fontsize: 50

            Label:
                text: ''
                fontsize: 50

            Label:
                text: ''
                fontsize: 50

            Label:
                text: ''
                fontsize: 50

            Label:
                text: ''
                fontsize: 50
                
            BoxLayout:
                id: test2
                orientation: 'horizontal'

                Label:
                    text: ''
                    fontsize: 50
                
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Button: 
                    text: 'Start'
                    color: .25, .25, .25, 1
                    background_color: (.2, .2, .2, 1.0)

                    on_release:
                        root.current = 'game_screen'
                        game.init(*splash.args)
                        Clock.schedule_interval(game.update, 1.0 / 60.0)
                
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

            Label:
                text: ''
                fontsize: 50
                
    Screen:
        name: 'game_screen'
        COGame:
            id: game

<COGame>:
    target1: target_1
    target2: target_2
    exit_target1: target_e1
    exit_target2: target_e2
    pd_indicator_targ: pd_indicator
    vid_indicator_targ: vid_indicator

    Target:
        id: pd_indicator
        
    Target:
        id: vid_indicator
        
    Target: 
        id: target_1
        
    Target: 
        id: target_2

    Target:
        id: target_e1

    Target:
        id: target_e2

    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 6/8
        top: root.top - 70
        text: str(root.trial_counter)

    
    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 2/8
        top: root.top - 170
        text: root.percent_correct_text
    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 5/8
        top: root.top - 170
        text: root.percent_correct

    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 2/8
        top: root.top - 270
        text: root.tht_text
    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 5/8
        top: root.top - 270
        text: root.tht_param


    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 2/8
        top: root.top - 470
        text: root.targ_size_text
    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 5/8
        top: root.top - 470
        text: root.targ_size_param


    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 2/8
        top: root.top - 570
        text: root.big_rew_text
    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 5/8
        top: root.top - 570
        text: root.big_rew_time_param


<Target>:
    canvas:
        Color:
            rgba:self.color
        Ellipse: 
            pos:self.pos
            size:self.size