#:kivy 1.10.0
#:import Clock kivy.clock.Clock

<Manager>:
    id: screen_manager

    Screen:
        name: 'home'

        BoxLayout
            id: starting
            orientation: 'vertical'
    
            Label:
                text: ''
                fontsize: 50

            Label:
                text: 'Welcome! Make a Selection in Each Row:'
                fontsize: 50
                color: 1,0,1,1
                canvas.before:
                    Color: 
                        rgb: 1,1,0

            BoxLayout 
                id: top
                orientation: 'horizontal'

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Reward Setup:        '
                    color: 1, 1, 0, 1

                Label: 
                    text: 'No Auto Reward (all manual)'

                CheckBox:
                    group: 'rew'
                    id: rew_noauto_chk
            
                Label: 
                    text: 'SMALL rew for any discrete touch'

                CheckBox:
                    group: 'rew'
                    id: rew_anytouch_chk
           
                Label: 
                    text: 'SMALL rew for any discrete touch\n pls BIG rew for target touch'

                CheckBox:
                    group: 'rew'
                    id: rew_anytouch_pls_targ_chk
            
                Label: 
                    text: 'BIG rew for target touch'

                CheckBox:
                    group: 'rew'
                    id: rew_targ_chk

                Label: 
                    text: 'SOUND for target touch'

                CheckBox:
                    group: 'rew'
                    id: sound_only_chk
                    active: True


                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

            BoxLayout
                id: starting2
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: 'Animal Names:'
                    color: 1, 1, 0, 1
                    fontsize: 50
                    
                Label: 
                    text: 'Haunting'
                    fontsize: 28
                    halign: 'center'                        
                
                CheckBox: 
                    group: 'check'
                    id: chk_h
                    active: True

                Label: 
                    text: 'Sandpiper'
                    fontsize: 28
                    halign: 'center'                        
                
                CheckBox: 
                    group: 'check'
                    id: chk_sand
                
                Label: 
                    text: 'Sabotage'
                    fontsize: 28
                    halign: 'center'                        
                
                CheckBox: 
                    group: 'check'
                    id: chk_sabo
                   
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout 
                id: small_rew
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'SMALL reward'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0.1 sec'

                CheckBox:
                    id: small_rew_pt1_sec
                    group: 'small_rew'
                    active: True

                Label: 
                    text: '0.3 sec'

                CheckBox:
                    id: small_rew_pt3_sec
                    group: 'small_rew'

                Label: 
                    text: '0.5 sec'

                CheckBox:
                    id: small_rew_pt5_sec
                    group: 'small_rew'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout 
                id: big_rew
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
                Label: 
                    text: 'BIG reward'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0.3 sec'

                CheckBox:
                    id: big_rew_pt3_sec
                    group: 'big_rew'

                Label: 
                    text: '0.5 sec'

                CheckBox:
                    id: big_rew_pt5_sec
                    group: 'big_rew'
                    active: True

                Label: 
                    text: '0.7 sec'

                CheckBox:
                    id: big_rew_pt7_sec
                    group: 'big_rew'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
            BoxLayout:
                id: params:
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Target Radius'
                    color: 1, 1, 0, 1

                Label: 
                    text: '.5 cm'
                CheckBox:
                    id: targ_rad_5
                    group: 'targ_cm'
                Label: 
                    text: '1.0 cm'

                CheckBox:
                    id: targ_rad_10
                    group: 'targ_cm'
                Label: 
                    text: '1.5 cm'

                CheckBox:
                    id: targ_rad_15
                    group: 'targ_cm'
                    active: True
                    
                Label: 
                    text: '2.0 cm'

                CheckBox:
                    id: targ_rad_20
                    group: 'targ_cm'
                Label: 
                    text: '3 cm'

                CheckBox:
                    id: targ_rad_30
                    group: 'targ_cm'  

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50
            
            BoxLayout:
                id: params:
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Reward Delay'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0 sec'
                CheckBox:
                    id: rew_del_0
                    group: 'rew_del'
                    active: True

                Label: 
                    text: '.4 sec'

                CheckBox:
                    id: rew_del_4
                    group: 'rew_del'

                Label: 
                    text: '.8 sec'

                CheckBox:
                    id: rew_del_8
                    group: 'rew_del'

                Label: 
                    text: '1.2 sec'

                CheckBox:
                    id: rew_del_12
                    group: 'rew_del'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: params:
                orientation: 'horizontal'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Use RH Cap'
                    color: 1, 1, 0, 1

                Label: 
                    text: 'Yes!'

                CheckBox:
                    id: yes_cap
                    group: 'cap'

                Label: 
                    text: 'No!'

                CheckBox:
                    id: no_cap
                    group: 'cap'
                    active: True

                Label:
                    text: ''
                    fontsize: 50

                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: params:
                orientation: 'horizontal'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

                Label: 
                    text: 'Target Hold Time'
                    color: 1, 1, 0, 1

                Label: 
                    text: '0.25 sec'

                CheckBox:
                    id: quarter_sec
                    group: 'hold_time'

                Label: 
                    text: '0.5 sec'

                CheckBox:
                    id: half_sec
                    group: 'hold_time'
                    active: True

                Label: 
                    text: '0.625 sec'

                CheckBox:
                    id: five_eighth_sec
                    group: 'hold_time'

                Label:
                    text: '0.75 sec'
                    fontsize: 50

                CheckBox:
                    id: three_quart_sec
                    group: 'hold_time'

                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: test
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                
                Label: 
                    text: 'Target Structure'
                    color: 1, 1, 0, 1

                Label: 
                    text: 'Random'
                CheckBox:
                    id: rand_targ
                    group: 'targ_struct'

                Label:
                    text: '4 Targs'
                CheckBox:
                    id: four_targ
                    group: 'targ_struct'
                    active: True

                Label:
                    text: '2 step CO'
                CheckBox:
                    id: co_targ
                    group: 'targ_struct'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: test
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                
                Label: 
                    text: 'Auto-Quit After: '
                    color: 1, 1, 0, 1

                Label: 
                    text: '25 trials'
                CheckBox:
                    id: twenty_five_trials
                    group: 'trials'

                Label:
                    text: '50 trials'
                CheckBox:
                    id: fifty_trials
                    group: 'trials'
                    active: True

                Label:
                    text: 'Dont AutoQuit'
                CheckBox:
                    id: no_trials
                    group: 'trials'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: test
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                
                Label: 
                    text: 'Allow Drag Finger Into Targ: '
                    color: 1, 1, 0, 1

                Label: 
                    text: 'Yes'
                CheckBox:
                    id: drag
                    group: 'drag'
                    active: True

                Label:
                    text: 'No'
                CheckBox:
                    id: no_drag
                    group: 'drag'
                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50

            BoxLayout:
                id: test
                orientation: 'horizontal'
                Label:
                    text: ''
                    fontsize: 50
                
                Label: 
                    text: 'Testing or Monkey Time?'
                    color: 1, 1, 0, 1

                Label: 
                    text: 'Testing'
                CheckBox:
                    id: testing
                    group: 'testing'

                Label:
                    text: 'Monkey Time -- in Room'
                CheckBox:
                    id: monk_time
                    group: 'testing'
                    active: True

                Label:
                    text: 'Monkey Time -- in Cage'
                CheckBox:
                    id: monk_time_in_cage
                    group: 'testing'

                Label:
                    text: ''
                    fontsize: 50
                Label:
                    text: ''
                    fontsize: 50


            Button:
                text: 'Play Centerout Game'
                halign: 'center'
                valign: 'middle'
                font_size: 50
                text_size: self.size
                on_release: 
                    root.current = 'game_screen'
                    game.init(dict(haun=chk_h.active, sand=chk_sand.active,sabo=chk_sabo.active), dict(rew_manual=rew_noauto_chk.active, rew_anytouch=rew_anytouch_chk.active, rew_any_pls_targ=rew_anytouch_pls_targ_chk.active, rew_targ=rew_targ_chk.active, snd_only=sound_only_chk.active, small_rew=[small_rew_pt1_sec.active, small_rew_pt3_sec.active, small_rew_pt5_sec.active], big_rew=[big_rew_pt3_sec.active, big_rew_pt5_sec.active, big_rew_pt7_sec.active]), 
                    dict(targ_rad=[targ_rad_5.active, targ_rad_10.active, targ_rad_15.active, targ_rad_20.active, targ_rad_30.active]), dict(rew_del=[rew_del_0.active, rew_del_4.active, rew_del_8.active, rew_del_12.active]), dict(test=[testing.active, monk_time.active, monk_time_in_cage.active]), dict(cap=[yes_cap.active, no_cap.active]), dict(hold=[quarter_sec.active, half_sec.active, five_eighth_sec.active, three_quart_sec.active]), dict(get_targets_rand=rand_targ.active, get_4targets=four_targ.active, get_targets_co=co_targ.active), dict(autoquit=[twenty_five_trials.active, fifty_trials.active, no_trials.active]), dict(drag=[drag.active, no_drag.active]))
                    Clock.schedule_interval(game.update, 1.0 / 60.0)
            Label:
                text: ''
                fontsize: 50
            Label:
                text: ''
                fontsize: 50

    Screen: 
        name: 'splash_start'
        BoxLayout
            id: splash
            orientation: 'vertical'
    
            Label:
                text: 'Parameters Noted! \n Prepare the Monkey! Pausing Until Start Buttons Pressed. '
                fontsize: 50

    Screen:
        name: 'game_screen'
        COGame:
            id: game

<COGame>:
    center_target: target_c
    periph_target: target_p
    exit_target1: target_e1
    exit_target2: target_e2

    Target:
        id: target_c
        
    Target: 
        id: target_p

    Target:
        id: target_e1

    Target:
        id: target_e2

    Label:
        color: .5,.5,.5,1
        font_size: 50
        center_x: root.width * 7/8
        top: root.top - 70
        text: str(root.trial_counter)

<Target>:
    canvas:
        Color:
            rgba:self.color
        Ellipse: 
            pos:self.pos
            size:self.size